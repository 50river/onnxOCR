<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ - é ˜åæ›¸OCRã‚¢ãƒ—ãƒª</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.5em;
        }

        .header p {
            margin: 0;
            opacity: 0.9;
            font-size: 1.1em;
        }

        .performance-info {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .performance-info h3 {
            margin-top: 0;
            color: #333;
        }

        .threshold-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .threshold-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007AFF;
        }

        .threshold-item .label {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .threshold-item .value {
            color: #666;
            font-size: 0.9em;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #ee5a24;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn.secondary {
            background: #6c757d;
        }

        .btn.secondary:hover {
            background: #545b62;
        }

        .progress {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ee5a24);
            width: 0%;
            transition: width 0.3s ease;
        }

        .results {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }

        .performance-grade {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1.5em;
            font-weight: bold;
        }

        .grade-a { background: #d4edda; color: #155724; }
        .grade-b { background: #d1ecf1; color: #0c5460; }
        .grade-c { background: #fff3cd; color: #856404; }
        .grade-d { background: #f8d7da; color: #721c24; }
        .grade-f { background: #f8d7da; color: #721c24; }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .summary-card {
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            color: white;
            font-weight: bold;
        }

        .summary-card.total { background: #6c757d; }
        .summary-card.passed { background: #28a745; }
        .summary-card.failed { background: #dc3545; }
        .summary-card.warnings { background: #ffc107; color: #212529; }
        .summary-card.errors { background: #fd7e14; }

        .summary-card .number {
            font-size: 2em;
            display: block;
            margin-bottom: 5px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ff6b6b;
        }

        .metric-card h4 {
            margin-top: 0;
            color: #333;
        }

        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 10px;
        }

        .metric-details {
            font-size: 0.9em;
            color: #666;
        }

        .category-results {
            margin-bottom: 30px;
        }

        .category-header {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px 8px 0 0;
            border-bottom: 2px solid #dee2e6;
            font-weight: bold;
            color: #495057;
        }

        .test-list {
            background: white;
            border-radius: 0 0 8px 8px;
            overflow: hidden;
        }

        .test-item {
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .test-item:last-child {
            border-bottom: none;
        }

        .test-info {
            flex: 1;
        }

        .test-name {
            font-weight: 500;
            color: #333;
            margin-bottom: 5px;
        }

        .test-message {
            font-size: 0.9em;
            color: #666;
        }

        .test-value {
            font-weight: bold;
            margin-right: 15px;
            color: #333;
        }

        .test-status {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .test-status.pass {
            background: #d4edda;
            color: #155724;
        }

        .test-status.fail {
            background: #f8d7da;
            color: #721c24;
        }

        .test-status.warn {
            background: #fff3cd;
            color: #856404;
        }

        .test-status.error {
            background: #f8d7da;
            color: #721c24;
        }

        .test-status.info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .recommendations {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .recommendations h4 {
            margin-top: 0;
            color: #856404;
        }

        .recommendation-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #ffc107;
        }

        .recommendation-item:last-child {
            margin-bottom: 0;
        }

        .recommendation-priority {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .priority-high {
            background: #dc3545;
            color: white;
        }

        .priority-medium {
            background: #ffc107;
            color: #212529;
        }

        .priority-low {
            background: #28a745;
            color: white;
        }

        .recommendation-issue {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .recommendation-solution {
            color: #666;
            font-size: 0.9em;
        }

        .console-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .console-output pre {
            margin: 0;
            white-space: pre-wrap;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .summary {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 14px;
                margin: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ</h1>
        <p>åˆå›OCRå‡¦ç†æ™‚é–“ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒ»ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã®æœ€é©åŒ–ç¢ºèª</p>
    </div>

    <div class="performance-info">
        <h3>ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™å€¤</h3>
        <div class="threshold-list">
            <div class="threshold-item">
                <div class="label">OCRå‡¦ç†æ™‚é–“</div>
                <div class="value">â‰¤ 10ç§’</div>
            </div>
            <div class="threshold-item">
                <div class="label">ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º</div>
                <div class="value">â‰¤ 50MB</div>
            </div>
            <div class="threshold-item">
                <div class="label">ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</div>
                <div class="value">â‰¤ 200MB</div>
            </div>
            <div class="threshold-item">
                <div class="label">åˆå›èª­ã¿è¾¼ã¿æ™‚é–“</div>
                <div class="value">â‰¤ 5ç§’</div>
            </div>
            <div class="threshold-item">
                <div class="label">ç”»åƒå‡¦ç†æ™‚é–“</div>
                <div class="value">â‰¤ 3ç§’</div>
            </div>
        </div>
    </div>

    <div class="controls">
        <button id="run-tests" class="btn">ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</button>
        <button id="clear-results" class="btn secondary" disabled>ğŸ—‘ï¸ çµæœã‚’ã‚¯ãƒªã‚¢</button>
    </div>

    <div id="progress" class="progress">
        <h3>â³ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...</h3>
        <div class="progress-bar">
            <div id="progress-fill" class="progress-fill"></div>
        </div>
        <div id="progress-text">æº–å‚™ä¸­...</div>
    </div>

    <div id="results" class="results">
        <div id="performance-grade" class="performance-grade">
            <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
        </div>

        <div class="summary">
            <div class="summary-card total">
                <span id="total-tests" class="number">0</span>
                <span>ç·ãƒ†ã‚¹ãƒˆæ•°</span>
            </div>
            <div class="summary-card passed">
                <span id="passed-tests" class="number">0</span>
                <span>æˆåŠŸ</span>
            </div>
            <div class="summary-card failed">
                <span id="failed-tests" class="number">0</span>
                <span>å¤±æ•—</span>
            </div>
            <div class="summary-card warnings">
                <span id="warning-tests" class="number">0</span>
                <span>è­¦å‘Š</span>
            </div>
            <div class="summary-card errors">
                <span id="error-tests" class="number">0</span>
                <span>ã‚¨ãƒ©ãƒ¼</span>
            </div>
        </div>

        <div id="metrics-grid" class="metrics-grid">
            <!-- ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚«ãƒ¼ãƒ‰ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
        </div>

        <div id="category-results">
            <!-- ã‚«ãƒ†ã‚´ãƒªåˆ¥çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
        </div>

        <div id="recommendations" class="recommendations" style="display: none;">
            <h4>ğŸ’¡ æœ€é©åŒ–æ¨å¥¨äº‹é …</h4>
            <div id="recommendations-list">
                <!-- æ¨å¥¨äº‹é …ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <div id="console-output" class="console-output" style="display: none;">
        <h4 style="color: #d4d4d4; margin-top: 0;">ğŸ“‹ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›</h4>
        <pre id="console-content"></pre>
    </div>

    <script src="performance-tests.js"></script>
    <script>
        let performanceTests;
        let consoleOutput = [];

        // ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;

        console.log = function(...args) {
            consoleOutput.push(`[LOG] ${args.join(' ')}`);
            updateConsoleOutput();
            originalConsoleLog.apply(console, args);
        };

        console.error = function(...args) {
            consoleOutput.push(`[ERROR] ${args.join(' ')}`);
            updateConsoleOutput();
            originalConsoleError.apply(console, args);
        };

        console.warn = function(...args) {
            consoleOutput.push(`[WARN] ${args.join(' ')}`);
            updateConsoleOutput();
            originalConsoleWarn.apply(console, args);
        };

        function updateConsoleOutput() {
            const consoleElement = document.getElementById('console-content');
            const consoleContainer = document.getElementById('console-output');
            
            if (consoleOutput.length > 0) {
                consoleElement.textContent = consoleOutput.join('\n');
                consoleContainer.style.display = 'block';
                consoleElement.scrollTop = consoleElement.scrollHeight;
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            performanceTests = new PerformanceTests();

            // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§è‡ªå‹•å®Ÿè¡Œã‚’ãƒã‚§ãƒƒã‚¯
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('run-performance-tests')) {
                setTimeout(runTests, 1000);
            }
        });

        async function runTests() {
            const runButton = document.getElementById('run-tests');
            const clearButton = document.getElementById('clear-results');
            const progressDiv = document.getElementById('progress');
            const resultsDiv = document.getElementById('results');

            // UIã®çŠ¶æ…‹ã‚’æ›´æ–°
            runButton.disabled = true;
            runButton.textContent = 'â³ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...';
            clearButton.disabled = true;
            progressDiv.style.display = 'block';
            resultsDiv.style.display = 'none';
            consoleOutput = [];

            try {
                // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹æ›´æ–°ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
                const progressSteps = [
                    { text: 'åˆå›èª­ã¿è¾¼ã¿æ™‚é–“ã‚’æ¸¬å®šä¸­...', progress: 15 },
                    { text: 'ãƒªã‚½ãƒ¼ã‚¹ã‚µã‚¤ã‚ºã‚’åˆ†æä¸­...', progress: 30 },
                    { text: 'ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’æ¸¬å®šä¸­...', progress: 45 },
                    { text: 'OCRãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ãƒ†ã‚¹ãƒˆä¸­...', progress: 60 },
                    { text: 'ç”»åƒå‡¦ç†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ãƒ†ã‚¹ãƒˆä¸­...', progress: 75 },
                    { text: 'ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ãƒ†ã‚¹ãƒˆä¸­...', progress: 90 },
                    { text: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’åˆ†æä¸­...', progress: 100 }
                ];

                for (const step of progressSteps) {
                    updateProgress(step.text, step.progress);
                    await new Promise(resolve => setTimeout(resolve, 300));
                }

                // å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
                const report = await performanceTests.runAllTests();
                
                // çµæœã®è¡¨ç¤º
                displayResults(report);

            } catch (error) {
                console.error('ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
                alert(`ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
            } finally {
                // UIã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
                runButton.disabled = false;
                runButton.textContent = 'ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ';
                clearButton.disabled = false;
                progressDiv.style.display = 'none';
            }
        }

        function updateProgress(text, progress) {
            document.getElementById('progress-text').textContent = text;
            document.getElementById('progress-fill').style.width = `${progress}%`;
        }

        function displayResults(report) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';

            // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚°ãƒ¬ãƒ¼ãƒ‰ã®è¡¨ç¤º
            displayPerformanceGrade(report.performanceGrade);

            // ã‚µãƒãƒªãƒ¼ã®æ›´æ–°
            document.getElementById('total-tests').textContent = report.summary.total;
            document.getElementById('passed-tests').textContent = report.summary.passed;
            document.getElementById('failed-tests').textContent = report.summary.failed;
            document.getElementById('warning-tests').textContent = report.summary.warnings;
            document.getElementById('error-tests').textContent = report.summary.errors;

            // ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®è¡¨ç¤º
            displayMetrics(report.metrics);

            // ã‚«ãƒ†ã‚´ãƒªåˆ¥çµæœã®è¡¨ç¤º
            displayCategoryResults(report);

            // æ¨å¥¨äº‹é …ã®è¡¨ç¤º
            if (report.recommendations && report.recommendations.length > 0) {
                displayRecommendations(report.recommendations);
            }

            console.log('ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼');
            console.log(`åˆæ ¼: ${report.summary.passed}/${report.summary.total}`);
            console.log(`æˆåŠŸç‡: ${(report.summary.passed / report.summary.total * 100).toFixed(1)}%`);
            console.log(`ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚°ãƒ¬ãƒ¼ãƒ‰: ${report.performanceGrade}`);
        }

        function displayPerformanceGrade(grade) {
            const gradeDiv = document.getElementById('performance-grade');
            gradeDiv.className = `performance-grade grade-${grade.toLowerCase()}`;
            
            const gradeTexts = {
                'A': 'ğŸ† å„ªç§€ (Grade A)',
                'B': 'ğŸ‘ è‰¯å¥½ (Grade B)',
                'C': 'âš ï¸ æ™®é€š (Grade C)',
                'D': 'ğŸ“‰ è¦æ”¹å–„ (Grade D)',
                'F': 'âŒ ä¸åˆæ ¼ (Grade F)'
            };
            
            gradeDiv.textContent = gradeTexts[grade] || `Grade ${grade}`;
        }

        function displayMetrics(metrics) {
            const metricsGrid = document.getElementById('metrics-grid');
            metricsGrid.innerHTML = '';

            // åˆå›èª­ã¿è¾¼ã¿æ™‚é–“
            if (metrics.initialLoad) {
                const card = createMetricCard(
                    'â±ï¸ åˆå›èª­ã¿è¾¼ã¿æ™‚é–“',
                    `${metrics.initialLoad.totalLoadTime.toFixed(0)}ms`,
                    `DOMèª­ã¿è¾¼ã¿: ${metrics.initialLoad.domContentLoadedTime.toFixed(0)}ms`
                );
                metricsGrid.appendChild(card);
            }

            // ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º
            if (metrics.resourceSizes) {
                const card = createMetricCard(
                    'ğŸ“¦ ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º',
                    formatBytes(metrics.resourceSizes.total),
                    `ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°: ${Object.keys(metrics.resourceSizes.breakdown).length}`
                );
                metricsGrid.appendChild(card);
            }

            // ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
            if (metrics.memory) {
                const card = createMetricCard(
                    'ğŸ§  ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡',
                    formatBytes(metrics.memory.usedJSHeapSize),
                    `ãƒ’ãƒ¼ãƒ—åˆ¶é™: ${formatBytes(metrics.memory.jsHeapSizeLimit)}`
                );
                metricsGrid.appendChild(card);
            }

            // OCRãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
            if (metrics.ocrPerformance) {
                const card = createMetricCard(
                    'ğŸ” OCRå‡¦ç†æ™‚é–“',
                    `${metrics.ocrPerformance.processingTime.toFixed(0)}ms`,
                    `ç”»åƒã‚µã‚¤ã‚º: ${metrics.ocrPerformance.imageSize}`
                );
                metricsGrid.appendChild(card);
            }

            // ç”»åƒå‡¦ç†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
            if (metrics.imageProcessing) {
                const card = createMetricCard(
                    'ğŸ–¼ï¸ ç”»åƒå‡¦ç†æ™‚é–“',
                    `${metrics.imageProcessing.processingTime.toFixed(0)}ms`,
                    `ç”»åƒã‚µã‚¤ã‚º: ${metrics.imageProcessing.imageSize}`
                );
                metricsGrid.appendChild(card);
            }

            // ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
            if (metrics.network) {
                const card = createMetricCard(
                    'ğŸŒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯',
                    `${metrics.network.averageResponseTime.toFixed(0)}ms`,
                    `ç·ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: ${metrics.network.totalRequests}`
                );
                metricsGrid.appendChild(card);
            }
        }

        function createMetricCard(title, value, details) {
            const card = document.createElement('div');
            card.className = 'metric-card';
            card.innerHTML = `
                <h4>${title}</h4>
                <div class="metric-value">${value}</div>
                <div class="metric-details">${details}</div>
            `;
            return card;
        }

        function displayCategoryResults(report) {
            const categoryResultsDiv = document.getElementById('category-results');
            categoryResultsDiv.innerHTML = '';

            Object.keys(report.categories).forEach(category => {
                const categoryData = report.categories[category];
                const categoryResults = report.results.filter(r => r.category === category);

                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category-results';

                const headerDiv = document.createElement('div');
                headerDiv.className = 'category-header';
                headerDiv.innerHTML = `
                    ${category} 
                    <span style="float: right;">
                        ${categoryData.passed}/${categoryData.total} æˆåŠŸ
                    </span>
                `;

                const testListDiv = document.createElement('div');
                testListDiv.className = 'test-list';

                categoryResults.forEach(result => {
                    const testItemDiv = document.createElement('div');
                    testItemDiv.className = 'test-item';

                    const statusClass = result.status.toLowerCase();

                    testItemDiv.innerHTML = `
                        <div class="test-info">
                            <div class="test-name">${result.test}</div>
                            <div class="test-message">${result.message}</div>
                        </div>
                        <div style="display: flex; align-items: center;">
                            ${result.value ? `<div class="test-value">${result.value}</div>` : ''}
                            <div class="test-status ${statusClass}">${result.status}</div>
                        </div>
                    `;

                    testListDiv.appendChild(testItemDiv);
                });

                categoryDiv.appendChild(headerDiv);
                categoryDiv.appendChild(testListDiv);
                categoryResultsDiv.appendChild(categoryDiv);
            });
        }

        function displayRecommendations(recommendations) {
            const recommendationsDiv = document.getElementById('recommendations');
            const recommendationsList = document.getElementById('recommendations-list');
            
            recommendationsList.innerHTML = '';
            recommendations.forEach(recommendation => {
                const item = document.createElement('div');
                item.className = 'recommendation-item';
                
                const priorityClass = `priority-${recommendation.priority.toLowerCase()}`;
                
                item.innerHTML = `
                    <div class="recommendation-priority ${priorityClass}">${recommendation.priority}</div>
                    <div class="recommendation-issue">${recommendation.issue}</div>
                    <div class="recommendation-solution">${recommendation.solution}</div>
                `;
                
                recommendationsList.appendChild(item);
            });

            recommendationsDiv.style.display = 'block';
        }

        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function clearResults() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('console-output').style.display = 'none';
            consoleOutput = [];
            
            // ã‚µãƒãƒªãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('total-tests').textContent = '0';
            document.getElementById('passed-tests').textContent = '0';
            document.getElementById('failed-tests').textContent = '0';
            document.getElementById('warning-tests').textContent = '0';
            document.getElementById('error-tests').textContent = '0';
            
            document.getElementById('clear-results').disabled = true;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        document.getElementById('run-tests').addEventListener('click', runTests);
        document.getElementById('clear-results').addEventListener('click', clearResults);
    </script>
</body>
</html>